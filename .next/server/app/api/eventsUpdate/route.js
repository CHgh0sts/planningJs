"use strict";(()=>{var e={};e.id=792,e.ids=[792],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4970:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>w,patchFetch:()=>U,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>c,staticGenerationAsyncStorage:()=>v});var s={};r.r(s),r.d(s,{PUT:()=>d});var n=r(3278),a=r(5002),i=r(4877),u=r(3524),o=r(1309);let p=new u.PrismaClient;async function d(e){try{let t;let{id:r,debutAt:s,finAt:n,afterDay:a}=await e.json();if(!r&&(!s||!n))return o.NextResponse.json({error:"Les heures de d\xe9but et de fin sont requises"},{status:400});let i=await p.event.findUnique({where:{id:parseInt(r,10)}});if(!i)return o.NextResponse.json({error:"\xc9v\xe9nement introuvable"},{status:404});if(s){let[e,n]=s.split(":").map(Number),a=new Date(i.date);a.setUTCHours(e),a.setUTCMinutes(n);let u=new Date(i.finAt);u.getTime()-a.getTime()<18e5&&(u=new Date(a.getTime()+18e5)),t=await p.event.update({where:{id:parseInt(r,10)},data:{debutAt:a,finAt:u}})}if(n){let e;if(a)(e=new Date(i.date)).setUTCDate(e.getUTCDate()+1),e.setUTCHours(0),e.setUTCMinutes(0);else{let[t,r]=n.split(":").map(Number);(e=new Date(i.date)).setUTCHours(t),e.setUTCMinutes(r)}let s=new Date(i.debutAt);e.getTime()-s.getTime()<18e5&&(s=new Date(e.getTime()-18e5)),t=await p.event.update({where:{id:parseInt(r,10)},data:{debutAt:s,finAt:e}})}return o.NextResponse.json(t,{status:200})}catch(e){return console.error(e),o.NextResponse.json({error:"Erreur lors de la mise \xe0 jour de l'\xe9v\xe9nement"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/eventsUpdate/route",pathname:"/api/eventsUpdate",filename:"route",bundlePath:"app/api/eventsUpdate/route"},resolvedPagePath:"/Users/chghosts/Developpement/planningJs/app/api/eventsUpdate/route.js",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:v,serverHooks:c}=l,w="/api/eventsUpdate/route";function U(){return(0,i.patchFetch)({serverHooks:c,staticGenerationAsyncStorage:v})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[379,833],()=>r(4970));module.exports=s})();